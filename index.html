<!DOCTYPE html>
<html>

<head>
    <title>My experiment</title>
    <script src="dist/jspsych.js"></script>
    <script src="dist/plugin-fullscreen.js"></script>
    <script src="dist/plugin-image-keyboard-response.js"></script>
    <script src="dist/plugin-preload.js"></script>
    <script src="dist/plugin-survey-text.js"></script>
    <script src="dist/plugin-html-button-response.js"></script>
    <script src="dist/plugin-survey-likert.js"></script>
    <script src="dist/plugin-html-keyboard-response.js"></script>
    <script src="dist/plugin-survey-html-form.js"></script>
    <script src="dist/plugin-image-button-response.js"></script>
    <script src="dist/plugin-survey.js"></script>
    <script src="dist/plugin-survey-multi-select.js"></script>
    <script src="dist/plugin-call-function.js"></script>
    <script src="test_sales_stimuli.js"></script>
    <link rel="stylesheet" href="dist/jspsych.css">
    <link rel="stylesheet" href="dist/survey.css">
    <link rel="stylesheet" href="./test_2.css">
</head>

<body>

</body>

<script type="text/javascript">
    /* Global Variables */

    var timeline = [];

    var data_list = [prac_simple, prac_complex]
    var test_sales_stimuli = data_list[Math.floor((Math.random() * data_list.length))]
    if (test_sales_stimuli == prac_simple) {
        var exp_sales_stimuli = exp_simple
    } else {
        var exp_sales_stimuli = exp_complex
    }
    var exp_sales_stimuli_part1 = [] //只有5个
    var index_list = []

    for (var i = 0; i < 5; i++) {
        var index = Math.floor(Math.random() * 31)
        if (-1 == index_list.indexOf(index)) {
            index_list.push(index)
        } else {
            i = i - 1
        }
    }

    for (var index of index_list) {
        exp_sales_stimuli_part1.push(exp_sales_stimuli[index])
    }

    var exp_sales_stimuli_part2 = exp_sales_stimuli.filter((n, i) => !index_list.includes(i));


    var scale = ["完全没有信心", "没有信心", "有点没有信心", "不确定", "有点信心", "有信心", "非常有信心"];


    var jsPsych = initJsPsych({
        default_ITI: 250,
        on_finish: function() {
            var date = new Date()
            var year = date.getFullYear()
            var month = date.getMonth() + 1
            var date1 = date.getDate()
            var hour = date.getHours()
            var minute = date.getMinutes()
            var seconds = date.getSeconds()
            var file_name_csv = "exp_data_" + year.toString() + '-' + month.toString() + '-' + date1.toString() + '-' + hour.toString() + '-' + minute.toString() + '-' + seconds.toString() + '.csv'
            var file_name_json = "exp_data_" + year.toString() + '-' + month.toString() + '-' + date1.toString() + '-' + hour.toString() + '-' + minute.toString() + '-' + seconds.toString() + '.json'
                //jsPsych.data.displayData();
            jsPsych.data.get().localSave('csv', file_name_csv);
            jsPsych.data.get().localSave('json', file_name_json);
            document.getElementById('jspsych-content').innerHTML += `<p class='context' style='font-size:1.375rem /* 22/16 */; text-align=center'>实验结束，感谢您的参与！</p>`
        }
    });

    var set_html_style = {
            type: jsPsychCallFunction,
            func: function() {
                //document.body.style.backgroundColor = 'rgb(250, 250, 250)' // background color
                document.body.style.backgroundColor = 'rgb(250, 250, 250)' // background color
                document.body.style.color = 'black' // font color
                    //document.body.style.fontSize = '20pt'
                    //document.body.style.fontFamily = '微软雅黑'
                    //document.body.style.fontWeight = 'bold' // 'normal', 'bold'
                document.body.style.lineHeight = '1.6em' // line space
                document.body.style.cursor = 'default' // 'default', 'none', 'wait', ...
                document.body.onselectstart = function() {
                        return false
                    } // 禁止选中文字 <body oncontextmenu="return false">
                document.body.oncontextmenu = function() {
                        return false
                    } // 禁用鼠标右键 <body onselectstart="return false">
                document.onkeydown = function() {
                    // 屏蔽键盘按键 (https://www.bejson.com/othertools/keycodes/)
                    if ((event.keyCode in {
                            27: 'Esc',
                            116: 'F5',
                            123: 'F12'
                        }) ||
                        (event.ctrlKey && event.keyCode in {
                            85: 'U'
                        })
                    ) {
                        return false
                    }
                }
            },
        }
        //timeline.push(set_html_style);


    var fullscreen_trial = {
        type: jsPsychFullscreen,
        fullscreen_mode: true
    };

    var preload = {
        type: jsPsychPreload,
        auto_preload: true
    };

    var exp_open_remarks = {
            type: jsPsychFullscreen,
            fullscreen_mode: true,
            message: `
                    <p style="font: bold 28pt 微软雅黑; color: #B22222"> 判断与预测实验 </p></br></br>
  
                    <p class='context' style='line-height: 1.8em'>您好！我们是浙江大学管理学院的研究团队，本次实验主要围绕<font color="red"> 判断与预测 </font>开展。接下来实验过程中，需要您<font color="red"> 做出判断和预测</font>。请放心，您的回复将完全保密。
                    <p class='context' style='text-indent:3.125rem /* 50/16 */'>1. 本实验分为两个阶段，您需要做出判断并填写问卷；
                    <p class='context' style='text-indent:3.125rem /* 50/16 */'>2. 完成本研究大约需要50分钟，实验期间您可以在任何时间退出实验且同意放弃相关酬金。
                    <p class='context' style='text-indent:3.125rem /* 50/16 */'>3. 请仔细阅读每一页的提示语，需要特别注意最后实验数据保存的要求，并及时联系实验人员。
                    <p class='context' style='text-indent:3.125rem /* 50/16 */'>4. 实验过程中请不要退出全屏模式。
                    <p class='context'>
                    <p class='context'>在了解和同意以上的注意事项后，请点击按钮进入全屏模式并进入实验环节。</p>
                    <p style="font: bold 32pt"> </p>
                    <p>
                    `,
            button_label: '全屏开始实验',
            delay_after: 100
        }
        //timeline.push(exp_open_remarks);

    var exp_game_task_intro = {
            type: jsPsychFullscreen,
            fullscreen_mode: true,
            message: `
                    <p style="font: bold 22pt 微软雅黑; text-align: left; line-height: 1.8em"> 【实验背景介绍】</p></br>
                    <p class='context'>在本实验中，您将模拟进行一项<font color="red">柠檬水经营游戏</font>。具体情境如下：</p></br>
                    <p class='context' style='text-indent:3.125rem /* 50/16 */'>· 您的角色是<font color="red">某公园柠檬水摊位的摊主</font>，主要任务是根据提供的信息<font color="red">预测柠檬水的销量</font>，以便提前准备好相关的制作材料。</p>
                    <p class='context' style='text-indent:3.125rem /* 50/16 */'>· 您接收到的信息是随机的，您可以使用提供的纸和笔辅助记录。</p></br>
                    <p class='context'>在本实验中，您有机会通过<font color="red">更精确的预测获得更多的实验报酬</font>，因此请仔细阅读所有的相关信息。</p>
                    <p>`,
            button_label: '查看酬金规则',
            delay_after: 100
        }
        //timeline.push(exp_game_task_intro);

    var exp_interest_intro = {
            type: jsPsychFullscreen,
            fullscreen_mode: true,
            message: `
                    <p style="font: 18pt 微软雅黑; text-align: left; line-height: 1.5em">【酬金规则介绍】</p>
                    <div class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.2em'>
                    本次实验酬金发放分为基本酬金和浮动酬金，其中：</br>
                    <p > 1. 基本酬金：完整参与实验，获得<font color="red">15</font>元。即最低获得15元的实验报酬。</p>
                    <p> 2. 浮动酬金：根据正式实验环节，总的浮动酬金共由两次浮动酬金组成<b>（具体酬金规则会在接下来相应的实验环节详细介绍）</b>: </p>
                    <p style='text-indent:5rem'> (1)正式实验环节1：浮动酬金1=<font color="red">平均预测收益</font>。</p>
                    <p style='text-indent:5rem'> (2)正式实验环节2：浮动酬金2=<font color="red">随机选取</font>某一次的预测收益。</p>
                    <p line-height: 0em> # 最终酬金=基本酬金+浮动酬金1+浮动酬金2。</p></div>
                    ——————————————————————————————————————————————————————<br/><br/>
                    <div style="text-indent:4.375rem /* 70/16 */; color:Gray; font:16px 微软雅黑; line-height: 0.8em; text-align:left"> 
                    例如，正式实验环节1的浮动酬金的简单计算示例（非真实实验数据）：<br/>
                    <p>· 售价：1元/杯</p>
                    <p>· 成本：0.2元/杯</p>
                    <p>· 预测偏差损失：每偏离正确销量一杯，损失2元</p>
                    <p>· 第一次预测15杯，实际销售13杯，第一次总收益：13x1-15x0.2-(15-13)x2 = 6元</p>
                    <p>· 第二次预测15杯，实际需求20杯，第二次总收益：15x1-15x0.2-(20-15)x2 = 2元</p>
                    <p>· 将两次的平均收益作为实验环节1的浮动酬金，则截止实验环节1的实验酬金为：15+(6+2)/2=19元</p>
                    </div>
                    ———————————————————————————————————————————————————————<br/>
                    <p style="text-indent:2.5rem /* 40/16 */; font:15px 微软雅黑; line-height: 0.8em; text-align:center">请仔细阅读现在提供的酬金信息，接下来会有一些酬金的计算问题。</p>
                    <p>`,
            button_label: '已了解酬金规则',
            delay_after: 100
        }
        //timeline.push(exp_interest_intro);

    var exp_interest_test = {
            type: jsPsychSurveyText,
            data: {
                task: 'exp_interest_test',
                answer1: 17.5,
                answer2: 16,
                answer3: 10
            },
            preamble: '为了让您更清楚本实验的酬金发放规则，请您在5分钟之内计算实验环节1的浮动酬金。（可使用提供的纸和笔）',
            questions: [{
                prompt: '1.售价1元/杯，制作成本0.25元/杯，预测偏差损失0.5元/杯，制作30杯，实际需求40杯，当天净收益为多少元？',

                required: true
            }, {
                prompt: '2.售价1元/杯，制作成本0.20元/杯，预测偏差损失1元/杯，预计制作20杯，实际销售20杯，当天净收益为多少元？',

                required: true
            }, {
                prompt: '3.售价1元/杯，制作成本0.3元/杯，预测偏差损失0.5元/杯，预计制作25杯，实际销售20杯，当天净收益为多少元？',

                required: true
            }],
            button_label: '确认提交',
        }
        //timeline.push(exp_interest_test);

    var exp_rule_intro = {
            type: jsPsychFullscreen,
            fullscreen_mode: true,
            message: `
                    <p style="font: 18pt 微软雅黑; text-align: left; line-height: 1.2em">【游戏要点】</p></br>
                    <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1em'>
                    作为经营类游戏，您的主要职责是根据<font color="red">5项相关信息预测相应的柠檬水销量</font>。5项相关信息的介绍如下：</p>
                    <div style="text-indent:4.375rem /* 70/16 */; font:20px SimSun; line-height: 0.8em; text-align:left">
                    <p>① <font color="red">日期</font>：月份和几号，例如8月15号。</p>
                    <p>② <font color="red">星期</font>：周一到周日。</p>
                    <p>③ <font color="red">气温</font>：摄氏度，根据天气预报得到。</p>
                    <p>④ <font color="red">降水量</font>：单位毫升，根据天气预报得到。</p>
                    <p>⑤ <font color="red">制作传单数</font>：当天制作的传单数量（传单的制作和发放成本暂时不考虑）。</p></div>
                    </br>
                   
                    <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1em'>
                        根据公园的相关规定和市场行情，以下信息<font color="red">短期内不会发生变化</font>：</p>
                    <div style="text-indent:4.375rem /* 70/16 */; font:20px SimSun; line-height: 0.8em; text-align:left">
                    <p>· 柠檬水售价：1 元/杯。</p>
                    <p>· 制作成本：0.2元/杯。</p>
                    <p>· 正式实验环节1的预测偏差损失：2元/杯。</p></div>
                    </br>

                    <div style="text-indent:2.5rem /* 40/16 */; font:18px SimSun; line-height: 0.8em; text-align:left">
                    <p>注意1：经营日期在两个月的时间内<font color="red">随机选取</font>，并不会按照时间顺序依次出现，因此务必仔细阅读出现的信息。</p>
                    <p>注意2：本次实验过程中的数据均根据来自现有数据集，不会出现根据您的预测修改真实结果的情况！</p></div>
                    

                    <p>`,
            button_label: '进入游戏',
            delay_after: 100
        }
        //timeline.push(exp_rule_intro);



    /* Blocks: 7 days self-prediction */

    var practice_trial_intro = {
            type: jsPsychFullscreen,
            fullscreen_mode: true,
            message: `
        <p style="font: 24px 微软雅黑; line-height: 1.5em; text-align:center">【练习阶段】</p></br>
        <div style="font:24px SimSun; line-height: 1.2em; text-align:center">
        <p>接下来您将进入游戏的练习阶段。</p>
        <p>练习阶段是为了帮助您更好地了解经营任务的一般情况，会影响您接下来的预测表现，因此请认真练习！</p>
        <p style='color:Gray;'>练习阶段的表现不计入浮动酬金随机抽取范围。</p>
        </div>
        <p>`,
            button_lable: '进入练习',
            delay_after: 100
        }
        //timeline.push(practice_trial_intro);

    var exp_predict_practice = {
        type: jsPsychHtmlButtonResponse,
        stimulus: function() {
            var html = `
                <p style="font: 20pt 微软雅黑; text-align: left; line-height: 1.5em;color:Gray; ">柠檬水销量预测</p></br>
                <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.2em'>
                请您根据以下信息预测柠檬水销量（售价1元/杯，成本0.2元/杯）：</p>
                <div style="text-indent:4.375rem /* 70/16 */; font:18pt SimSun; line-height: 1em; text-align:left">
                <p>① 日期：${jsPsych.timelineVariable('Date')}</font>：</p>
                <p>② 星期：${jsPsych.timelineVariable('Day')}</p>
                <p>③ 气温：${jsPsych.timelineVariable('Temperature')}°C</p>
                <p>④ 降水量：${jsPsych.timelineVariable('Rainfall')}ml</p>
                <p>⑤ 制作传单数：${jsPsych.timelineVariable('Flyers')}张</p></div>
                </br></br>
                <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.2em'>
                请您仔细阅读以上信息，接下来一页需要您填写预测销量。</p>
                </br></br>
                `;
            return html;
        },
        choices: ['填写预测销量']
    }

    var exp_predict_practice_result = {
        type: jsPsychSurvey,
        pages: [
            [{
                type: 'html',
                prompt: '请根据提供的5项信息，进行预测：'
            }, {
                type: 'text',
                prompt: '1. 您预计制作多少杯柃檬水？',
                name: 'pred_num_practice',
                required: true
            }, {
                type: 'likert',
                prompt: '2. 您对自己的预测结果有多大信心？',
                name: 'pred_confi_practice',
                required: true,
                likert_scale_min_label: '完全没有信心',
                likert_scale_max_label: '非常有信心',
                likert_scale_values: [{
                    value: 1,
                }, {
                    value: 2
                }, {
                    value: 3
                }, {
                    value: 4
                }, {
                    value: 5
                }, {
                    value: 6
                }, {
                    value: 7
                }]
            }]
        ],
        button_label_finish: '提交预测结果',
        data: {
            task: jsPsych.timelineVariable('Date')
        }
    }

    var exp_predict_practice_result_eval = {
        type: jsPsychHtmlKeyboardResponse,
        data: {
            task: 'pre_eval',
            turevalue: jsPsych.timelineVariable('Sales'),
        },
        stimulus: function() {
            var self_pre = jsPsych.data.get().filter({
                task: jsPsych.timelineVariable('Date')
            }).values()[0]
            var self_pre = eval(JSON.parse(JSON.stringify(self_pre))).response.pred_num_practice
                //var self_pre = parseInt(self_pre)
            var ture_sale = jsPsych.timelineVariable('Sales')
                //var ture_sale = parseInt(ture_sale)
            var daily_profit = (self_pre > ture_sale) ? (ture_sale - self_pre * 0.2) : (self_pre * 0.8)
            var bias_loss = (Math.abs(self_pre - ture_sale)) * 2
            var bias_percent = ((Math.abs(self_pre - ture_sale)) / ture_sale) * 100
            var bias_percent = Math.floor(bias_percent * 100) / 100
            var final_profit = daily_profit - bias_loss
            var final_profit = Math.floor(final_profit * 100) / 100
            return `
                            <p style="font: 20pt 微软雅黑; line-height: 1.5em;color:Gray; text-align:center">【销量预测结果评估】</p></br>
                            <div style="font:20pt SimSun; line-height: 1em; text-align:center; color:black">
                            <p>实际销量为${ture_sale}杯</p>
                            <p>您的预测为${self_pre}杯</p>
                            <p>您的预测偏差百分比为${bias_percent}%</p>
                            <p>您本次的预测收益为${final_profit}元</p></br>
                            <p style='color:Gray;'>（按任意键继续）</p>
                            </div>`
        },
    }

    var exp_pre_pract7 = {
            timeline: [exp_predict_practice, exp_predict_practice_result, exp_predict_practice_result_eval],
            timeline_variables: test_sales_stimuli,
            data: {
                phase: 'pre_pract'
            },
            sample: {
                type: 'without-replacement',
                size: 7
            }
        }
        //timeline.push(exp_pre_pract7)



    /*操纵环节*/
    var images = ['images/High_PDB.png', 'images/Low_PDB.png', 'images/Expert_user.png', 'images/Experts.png'];
    var preload = {
        type: jsPsychPreload,
        images: images
    };

    //PDB(需要加一张空白的)

    var PDB_variables = [{
        PDB: 'images/High_PDB.png',
        name: 'high_PDB'
    }, {
        PDB: 'images/Low_PDB.png',
        name: 'low_PDB'
    }]

    var PDB_scale = ['社会等级非常重要', '社会等级重要', '社会等级有点重要', '社会等级和社会平等一样重要', '社会平等有点重要', '社会平等重要', '社会平等非常重要']

    var PDB_manip = {
        timeline: [{
            type: jsPsychFullscreen,
            fullscreen_mode: true,
            message: `
                <p style="font: 20pt 微软雅黑; text-align: left; line-height: 1.5em;color:Gray; ">【活动邀请】</p></br>
                <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.5em'>
                在准备接下来的经营预测之前，请注意以下事件：</p>
                <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.5em'>
                公园最近在举办一场<font color='red'>国际文化周签名征集活动</font>，您也收到了活动宣传单.</p>
                </br></br>
                <p>`,
            button_label: '阅读宣传单',
            delay_after: 100
        }, {
            type: jsPsychHtmlButtonResponse,
            data: {
                PDB_condition: jsPsych.timelineVariable('name')
            },
            stimulus: function() {
                var html = `
                    <p style="line-height: 2em;"></p></br>
                    <img src="${jsPsych.timelineVariable('PDB')}" width="500"></br>
                    <p style="font: 15pt SimSun; text-align: center; line-height: 1.5em; ">在仔细阅读完宣传单之后，为了表达对国际文化宣传周活动的支持及对宣传内容的认同，请您在下方输入您的姓名。（例如，张三）</p>
                    <p> <input type='text' rows='4'></p>
                    `;
                return html;
            },
            choices: ['继续']
        }, {
            type: jsPsychSurveyLikert,
            preamble: `
                    <p style="font: 16pt 微软雅黑; text-align: left; line-height: 1.6em">
                    <b>
                        根据公园开展的“国际文化宣传周”的宣传内容，请协助回答以下问题：<br/>
                    </p>`,
            questions: [{
                prompt: "到目前为止我主要认为：",
                name: 'PDB_manip_1',
                labels: PDB_scale,
                required: true
            }, {
                prompt: "此时此刻我觉得：",
                name: 'PDB_manip_2',
                labels: PDB_scale,
                required: true
            }, {
                prompt: "我现在的想法完全赞成：",
                name: 'PDB_manip_3',
                labels: PDB_scale,
                required: true
            }, ],
        }],
        timeline_variables: PDB_variables,
        sample: {
            type: 'without-replacement',
            size: 1
        }
    }


    var PDB_condition_random = {
            timeline: [PDB_manip],
            conditional_function: function() {
                var conditional_PDB = Math.floor(Math.random() * 3) + 1
                if (conditional_PDB == 1) {
                    return false;
                } else {
                    return true;
                }
            }
        }
        //timeline.push(PDB_condition_random);

    var exp_pre_pract_end = {
            type: jsPsychFullscreen,
            fullscreen_mode: true,
            message: `

                            <p style="font: 20pt 微软雅黑; line-height: 1.5em;color:Gray; text-align:center">【练习阶段结束】</p></br>
                            <div style="font:20pt SimSun; line-height: 1em; text-align:center; color:black">
                            <p>请点击按钮进入正式预测环节（1）。</p></br>
                            <p style='color:Gray;'>您的决策准确性决定了您的收益，因此请认真阅读信息。</p></br></br>
                            </div>
                <p>`,
            button_label: '进入正式预测',
            delay_after: 100
        }
        //timeline.push(exp_pre_pract_end);


    //Group_compostition

    var team_variables = [{
        team: 'images/Expert_user.png',
        name: '专业人员和终端用户组成的算法团队'
    }, {
        team: 'images/Experts.png',
        name: '完全专业人员组成的算法团队'
    }]

    var exp_team_intro = {
            type: jsPsychFullscreen,
            fullscreen_mode: true,
            message: `
            <p style="font: 20pt 微软雅黑; text-align: left; line-height: 1.5em;color:Gray; ">【正式预测环节】</p></br>
            <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.5em'>
            在您做出下一次预测前，收到一封关于<font color='red'>AI预测算法</font>的介绍邮件。</p>
            <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.5em'>
            该AI预测算法可能会参加到接下来的预测活动。</p>
            <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.5em'>
            请查阅邮件并仔细了解关于该算法的信息。</p>
            </br></br>
            <p>`,
            button_label: '查阅邮件',
            delay_after: 100
        }
        //timeline.push(exp_team_intro);

    var team_manip = {
            timeline: [{
                type: jsPsychHtmlButtonResponse,
                data: {
                    task: 'team_manip',
                    team_condition: jsPsych.timelineVariable('name')
                },
                stimulus: function() {
                    var html = `
                    <img src="${jsPsych.timelineVariable('team')}" width='75%'></br></br>
                    `;
                    return html;
                },
                choices: ['已了解邮件内容']
            }],
            timeline_variables: team_variables,
            sample: {
                type: 'without-replacement',
                size: 1
            }
        }
        //timeline.push(team_manip);

    likert_scale = [{
        value: 1,
    }, {
        value: 2
    }, {
        value: 3
    }, {
        value: 4
    }, {
        value: 5
    }, {
        value: 6
    }, {
        value: 7
    }];

    var exp_algo_delegation_1 = {
            type: jsPsychSurvey,
            pages: [
                [{
                    type: 'html',
                    prompt: `
                            <p style='line-height: 1.2em'>* 对于接下来规定次数内的预测收益，您有<font color="red">两种选择</font>:</p>
                            <p style='text-indent:2.1875rem /* 35/16 */; line-height: 1.2em'>① <font color="red">全部自己预测</font>，并将自己预测的平均收益作为正式实验阶段1的收益</p>
                            <p style='text-indent:2.1875rem /* 35/16 */; line-height: 1.2em'>② <font color="red">全部算法预测</font>，并将算法预测的平均收益作为正式实验阶段1的收益</p>
                            <p style='line-height: 1.2em; color:Gray'>例如，将接下来5次的预测交给算法，则随机从算法的5次预测收益中抽取一次作为您的预测收益；如果选择接下来5次自己预测，则随机从您5次的预测收益中抽取一次。</p>
                            `
                }, {
                    type: 'likert',
                    prompt: '· 请问您有多大意愿使用该算法预测接下来5次的柠檬水销量？',
                    required: true,
                    likert_scale_min_label: '完全不愿使用',
                    likert_scale_max_label: '非常愿意使用',
                    likert_scale_values: likert_scale
                }, {
                    type: 'multi-choice',
                    prompt: '· 请您决定是否让该算法为您做接下来5次的销量预测:',
                    options: ["不使用算法", "使用算法"],
                    required: true,
                }]
            ],
            data: {
                task: 'delegate_decision_1'
            },
            button_label_finish: '继续'
        }
        //timeline.push(exp_algo_delegation_1)

    var algo_delegation_yes_1_intro = {
            type: jsPsychFullscreen,
            fullscreen_mode: true,
            message: function() {
                var team_intro_info = jsPsych.data.get().filter({
                    task: 'team_manip'
                }).values()[0]
                var team_info = eval(JSON.parse(JSON.stringify(team_intro_info))).team_condition
                var html = `
            <p style="font: 20pt 微软雅黑; line-height: 1.5em;color:Gray; text-align:center">【您已授权 ${team_info}提供的AI算法 为您做接下来5次的销量预测】</p></br>
            <div style="font:20pt SimSun; line-height: 1em; text-align:center; color:black">
            <p>接下来您将依次看到5次算法预测结果。</p></br>
         
            </div>
            <p>`;
                return html;
            },
            delay_after: 100,
            button_label: '继续',
        }
        //timeline.push(algo_delegation_yes_1_intro);

    var if_shown_algo_delegation_yes_1_intro = {
        timeline: [algo_delegation_yes_1_intro],
        conditional_function: function() {
            var delegated = jsPsych.data.get().filter({
                task: 'delegate_decision_1'
            }).values()[0]
            var delegated = JSON.stringify(delegated)
            var delegated = eval(JSON.parse(delegated)).response.P0_Q2
            if (jsPsych.pluginAPI.compareKeys(delegated, '使用算法')) {
                return true;
            } else {
                return false;
            }
        }
    };
    timeline.push(if_shown_algo_delegation_yes_1_intro)

    var algo_delegation_no_1_intro = {
            type: jsPsychFullscreen,
            fullscreen_mode: true,
            message: function() {
                var team_intro_info = jsPsych.data.get().filter({
                    task: 'team_manip'
                }).values()[0]
                var team_info = eval(JSON.parse(JSON.stringify(team_intro_info))).team_condition
                var html = `
            <p style="font: 20pt 微软雅黑; line-height: 1.5em;color:Gray; text-align:center">【您未授权 ${team_info}提供的AI算法 为您做接下来5次的销量预测】</p></br>
            <div style="font:20pt SimSun; line-height: 1em; text-align:center; color:black">
            <p>接下来您将自己依次进行5次销量预测。</p></br>
         
            </div>
            <p>`;
                return html;
            },
            delay_after: 100,
            button_label: '继续',
        }
        //timeline.push(algo_delegation_yes_1_intro);

    var if_shown_algo_delegation_no_1_intro = {
        timeline: [algo_delegation_no_1_intro],
        conditional_function: function() {
            var delegated = jsPsych.data.get().filter({
                task: 'delegate_decision_1'
            }).values()[0]
            var delegated = JSON.stringify(delegated)
            var delegated = eval(JSON.parse(delegated)).response.P0_Q2
            if (jsPsych.pluginAPI.compareKeys(delegated, '不使用算法')) {
                return true;
            } else {
                return false;
            }
        }
    };
    timeline.push(if_shown_algo_delegation_no_1_intro)


    var algo_delegation_yes_1 = {
        type: jsPsychHtmlButtonResponse,
        stimulus: function() {
            var html = `
                <p style="font: 20pt 微软雅黑; text-align: left; line-height: 1.5em;color:Gray; ">【您已授权算法进行5次连续预测】</br>
                <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.2em;font-size=1.5rem'>
                请依次查看算法预测详情：</p>
                <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.2em'>
                # 预测使用的基本信息（售价1元/杯，成本0.2元/杯）：</p>
                <div style="text-indent:4.2rem /* 70/16 */; font:18pt SimSun; line-height: 1em; text-align:left">
                <p>① 日期：${jsPsych.timelineVariable('Date')}：</p>
                <p>② 星期：${jsPsych.timelineVariable('Day')}</p>
                <p>③ 气温：${jsPsych.timelineVariable('Temperature')}°C</p>
                <p>④ 降水量：${jsPsych.timelineVariable('Rainfall')}ml</p>
                <p>⑤ 制作传单数：${jsPsych.timelineVariable('Flyers')}张</p></div>
                </br></br>
 
                `;
            return html;
        },
        choices: ['点击查看算法预测销量']
    }

    var algo_delegation_yes_result_1 = {
        type: jsPsychSurvey,
        data: {
            task: 'exp_detail_info',
            turevalue: jsPsych.timelineVariable('Sales'),
            predictvalue: jsPsych.timelineVariable('Algo_pred_w'),
            taskdate: jsPsych.timelineVariable('Date')
        },
        pages: [
            [{
                type: 'html',
                prompt: function() {
                    var team_intro_info = jsPsych.data.get().filter({
                        task: 'team_manip'
                    }).values()[0]
                    var team_info = eval(JSON.parse(JSON.stringify(team_intro_info))).team_condition
                    var html = `
                        <p style="font: 20px 微软雅黑; text-align: left; line-height: 1.5em;color:Gray; "></p></br>
                    <p style="font:24px SimSun; line-height: 1.5em; text-align:left; color:black">
                    根据预测信息，<b>${team_info}</b>提供的算法的预测结果为：<b>${jsPsych.timelineVariable('Algo_pred_w')}</b>杯</p>
                    </p>
                    </br></br>
                `
                    return html
                }
            }, {
                type: 'likert',
                prompt: '· 如果本次您自己预测，您认为您自己的预测结果和算法的预测结果哪一个更接近真实的销量？（越接近7则认为算法结果更好）',
                name: 'algo_delegate_part1_comparison',
                required: true,
                likert_scale_min_label: '自己的预测结果',
                likert_scale_max_label: '算法的预测结果',
                likert_scale_values: likert_scale
            }]
        ],
        button_label_finish: '继续'

    }


    var if_shown_algo_delegation_1 = {
        timeline: [algo_delegation_yes_1, algo_delegation_yes_result_1],
        conditional_function: function() {
            var delegated = jsPsych.data.get().filter({
                task: 'delegate_decision_1'
            }).values()[0]
            var delegated = JSON.stringify(delegated)
            var delegated = eval(JSON.parse(delegated)).response.P0_Q2
            if (jsPsych.pluginAPI.compareKeys(delegated, '使用算法')) {
                return true;
            } else {
                return false;
            }
        }
    };

    //选择不使用算法
    var algo_delegation_no_1 = {
        type: jsPsychHtmlButtonResponse,
        stimulus: function() {
            var html = `
                <p style="font: 20pt 微软雅黑; text-align: left; line-height: 1.5em;color:Gray; "></p></br>
                <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.2em'>
                请您根据提供的信息预测柠檬水销量：</p>
                <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.2em'>
                # 预测使用的基本信息（售价1元/杯，成本0.4元/杯）：</p>
                <div style="text-indent:4.375rem /* 70/16 */; font:18pt SimSun; line-height: 1em; text-align:left">
                <p>① 日期：${jsPsych.timelineVariable('Date')}：</p>
                <p>② 星期：${jsPsych.timelineVariable('Day')}</p>
                <p>③ 气温：${jsPsych.timelineVariable('Temperature')}°C</p>
                <p>④ 降水量：${jsPsych.timelineVariable('Rainfall')}ml</p>
                <p>⑤ 制作传单数：${jsPsych.timelineVariable('Flyers')}张</p></div>
                </br></br>
 
                `;
            return html;
        },
        choices: ['点击填写预测销量']
    }

    var algo_delegation_no_result_1 = {
        type: jsPsychSurvey,
        pages: [
            [{
                type: 'html',
                prompt: function() {
                    var team_intro_info = jsPsych.data.get().filter({
                        task: 'team_manip'
                    }).values()[0]
                    var team_info = eval(JSON.parse(JSON.stringify(team_intro_info))).team_condition
                    var html = `  
                    <p>您未授权${team_info}提供的算法进行预测，因此请根据以上信息自己进行预测：</p>`
                    return html
                }
            }, {
                type: 'text',
                prompt: '· 您预计制作多少杯柃檬水？',
                name: 'pred_num',
                required: true
            }, {
                type: 'likert',
                prompt: '· 您对自己的预测结果有多大信心？',
                name: 'pred_confi_practice',
                required: true,
                likert_scale_min_label: '完全没有信心',
                likert_scale_max_label: '非常有信心',
                likert_scale_values: likert_scale
            }, {
                type: 'likert',
                prompt: '· 如果本次算法也参与预测，您认为您自己的预测结果和算法的预测结果哪一个更接近真实的销量？（越接近7则认为算法结果更好）',
                name: 'algo_delegate_part1_comparison',
                required: true,
                likert_scale_min_label: '自己的预测结果',
                likert_scale_max_label: '算法的预测结果',
                likert_scale_values: likert_scale
            }]
        ],
        button_label_finish: '提交预测结果',
        data: {
            task: 'exp_detail_info',
            taskdate: jsPsych.timelineVariable('Date'),
            turevalue: jsPsych.timelineVariable('Sales'),
        },
    }

    var if_shown_no_algo_delegation_1 = {
        timeline: [algo_delegation_no_1, algo_delegation_no_result_1],
        conditional_function: function() {
            var delegated = jsPsych.data.get().filter({
                task: 'delegate_decision_1'
            }).values()[0]
            var delegated = JSON.stringify(delegated)
            var delegated = eval(JSON.parse(delegated)).response.P0_Q2
            if (jsPsych.pluginAPI.compareKeys(delegated, '不使用算法')) {
                return true;
            } else {
                return false;
            }
        }
    };


    var exp_delegation_part1_1 = {
            timeline: [if_shown_algo_delegation_1, if_shown_no_algo_delegation_1],
            timeline_variables: exp_sales_stimuli_part1,
            data: {
                phase: 'exp_delegation_part1'
            },
            sample: {
                type: 'without-replacement',
                size: 5
            }
        }
        //timeline.push(exp_delegation_part1_1)


    // important measurement
    var key_factors_survey_1 = {
            type: jsPsychFullscreen,
            fullscreen_mode: true,
            message: `
        <p style="font: 20pt 微软雅黑; line-height: 1.5em; text-align:center">【问卷填写】</p></br>
        <div style="font:20pt SimSun; line-height: 1em; text-align:center">
        <p>接下来您将进入第一阶段的问卷填写。</p>
        <p>填写结果影响到您之后的实验报酬，因此请认真填写！</p>
        <p style='color:Gray;'>（按任意键继续）</p>
        </div>
        <p>`,
            button_lable: '填写问卷',
            delay_after: 100
        }
        //timeline.push(key_factors_survey_1)


    var variables_measurement = {
            type: jsPsychSurvey,
            pages: [
                [{
                    type: 'text',
                    prompt: function() {
                        var delegated = jsPsych.data.get().filter({
                            task: 'delegate_decision_1'
                        }).values()[0]
                        var delegated = JSON.stringify(delegated)
                        var delegated = eval(JSON.parse(delegated)).response.P0_Q2
                        var html = `                       
                            请详细说明您为什么选择 ${delegated} ：
                        `
                        return html
                    },
                    textbox_rows: 3,
                    name: 'decision_reason',
                    required: true
                }],
                [{
                    type: 'likert',
                    prompt: '· 您认为这个团队设计合格的AI预测算法的能力有多大？',
                    likert_scale_min_label: '能力很低',
                    likert_scale_max_label: '能力很高',
                    name: 'Ability_1',
                    likert_scale_values: likert_scale,
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您认为这个团队具备怎样的能力提供一个合格的AI预测算法？',
                    likert_scale_min_label: '很弱的能力',
                    likert_scale_max_label: '很强的能力',
                    name: 'Ability_2',
                    likert_scale_values: likert_scale,
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您认为这个团队在设计AI预测算法时的整体能力如何？',
                    likert_scale_min_label: '整体很差劲',
                    likert_scale_max_label: '整体很出色',
                    name: 'Ability_3',
                    likert_scale_values: likert_scale,
                    required: true,
                }, ],
                [{
                    type: 'likert',
                    prompt: '· 您现在认同这个算法设计团队吗？',
                    likert_scale_min_label: '完全不认同',
                    likert_scale_max_label: '完全认同',
                    likert_scale_values: likert_scale,
                    name: 'Indentification_1',
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '·您认为您和这个算法团队关系亲近吗？',
                    likert_scale_min_label: '非常不亲近',
                    likert_scale_max_label: '非常亲近',
                    likert_scale_values: likert_scale,
                    name: 'Indentification_2',
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您认为您和这个算法团队之间存在关系纽带吗？',
                    likert_scale_min_label: '完全不存在',
                    likert_scale_max_label: '完全存在',
                    likert_scale_values: likert_scale,
                    name: 'Indentification_3',
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您认为您和这个算法团队之间的有关联吗？',
                    likert_scale_min_label: '没有关联',
                    likert_scale_max_label: '有关联',
                    likert_scale_values: likert_scale,
                    name: 'Indentification_4',
                    required: true,
                }, ],
                [{
                    type: 'likert',
                    prompt: '· 您觉得当前这个算法存在比自己预测表现好的优势吗？',
                    likert_scale_min_label: '完全不存在',
                    likert_scale_max_label: '完全存在',
                    likert_scale_values: likert_scale,
                    name: 'Effectiveness_1',
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您现在认为这个算法可能是有用的吗？',
                    likert_scale_min_label: '肯定没用',
                    likert_scale_max_label: '肯定有用',
                    likert_scale_values: likert_scale,
                    name: 'Effectiveness_2',
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您现在猜测这个算法的表现会很不错吗？',
                    likert_scale_min_label: '绝对不会表现很好',
                    likert_scale_max_label: '绝对会表现很好',
                    likert_scale_values: likert_scale,
                    name: 'Effectiveness_3',
                    required: true,
                }, ],
                [{
                    type: 'likert',
                    prompt: '· 您觉得当前这个算法存在比自己预测表现好的优势吗？',
                    likert_scale_min_label: '完全不存在',
                    likert_scale_max_label: '完全存在',
                    likert_scale_values: likert_scale,
                    name: 'Effectiveness_1',
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您现在认为这个算法可能是有用的吗？',
                    likert_scale_min_label: '肯定没用',
                    likert_scale_max_label: '肯定有用',
                    likert_scale_values: likert_scale,
                    name: 'Effectiveness_2',
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您现在猜测这个算法的表现会很不错吗？',
                    likert_scale_min_label: '绝对不会表现很好',
                    likert_scale_max_label: '绝对会表现很好',
                    likert_scale_values: likert_scale,
                    name: 'Effectiveness_3',
                    required: true,
                }, ],
                [{
                    type: 'likert',
                    prompt: '· 您认为该算法的过程和结果有多大程度是可控的？',
                    likert_scale_min_label: '完全不可控',
                    likert_scale_max_label: '完全可控',
                    likert_scale_values: likert_scale,
                    name: 'Control level',
                    required: true,
                }, {
                    type: 'html',
                    prompt: `
                            <p class='context'></p></br></br>
                            <p style='text-indent:2.1875rem /* 35/16 */; line-height: 1.2em'>在心理学中，控制指的是个人感知自己具备的影响自己、他人、环境的能力，对自己或他人的控制可以影响个人的情绪和行为。</p>
                            <p style='text-indent:2.1875rem /* 35/16 */; line-height: 1.2em'>研究表明，在AI情境下，有人认为自己完全没有能力去控制AI，AI完全是失控的；也有人认为自己可以自由地控制AI设计、使用和更新等环节。</p>
                            <p style='text-indent:2.1875rem /* 35/16 */; line-height: 1.2em'>根据对控制的介绍以及已知的算法信息，回答下列问题。`
                }, {
                    type: 'likert',
                    prompt: '· 请问您认为您对当前这个预测算法从设计到得到结果的整体控制感有多大？',
                    likert_scale_min_label: '控制感很低',
                    likert_scale_max_label: '控制感很高',
                    likert_scale_values: likert_scale,
                    name: 'Perceived_control1',
                    required: true,
                }],
                [{
                    type: 'likert',
                    prompt: '· 在面对该算法的时候，您认为自己很强大吗？',
                    likert_scale_min_label: '完全不强大',
                    likert_scale_max_label: '非常强大',
                    likert_scale_values: likert_scale,
                    name: 'Perceived_control2_1',
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您认为自己可以控制这个算法吗？',
                    likert_scale_min_label: '完全不可以',
                    likert_scale_max_label: '完全可以',
                    likert_scale_values: likert_scale,
                    name: 'Perceived_control2_2',
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您觉得您有能力极大地改变该算法吗？',
                    likert_scale_min_label: '完全没有能力',
                    likert_scale_max_label: '完全有能力',
                    likert_scale_values: likert_scale,
                    name: 'Perceived_control2_3',
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您认为您可以影响该算法的设计和结果吗？',
                    likert_scale_min_label: '完全不可以',
                    likert_scale_max_label: '完全可以',
                    likert_scale_values: likert_scale,
                    name: 'Perceived_control2_4',
                    required: true,
                }, ],
                [{
                    type: 'likert',
                    prompt: '· 您在多大程度上信任此算法可以高质量地预测了接下来一天的最佳柠檬水制作数量？',
                    likert_scale_min_label: '完全不信任',
                    likert_scale_max_label: '完全信任',
                    likert_scale_values: likert_scale,
                    name: 'Trust1',
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您认为这是一个值得信任的算法吗？',
                    likert_scale_min_label: '完全不值得信任',
                    likert_scale_max_label: '完全值得信任',
                    likert_scale_values: likert_scale,
                    name: 'Trust1_2',
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您认为自己会依赖这个算法提供一个精确的预测值吗？',
                    likert_scale_min_label: '完全不会依赖',
                    likert_scale_max_label: '完全会依赖',
                    likert_scale_values: likert_scale,
                    name: 'Trust1_3',
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您相信这个算法的设计意图是好的吗？',
                    likert_scale_min_label: '完全不相信',
                    likert_scale_max_label: '完全相信',
                    likert_scale_values: likert_scale,
                    name: 'Trust1_4',
                    required: true,
                }],

                [{
                    type: 'likert',
                    prompt: '· 您认为柠檬水预测工作对您来说是一项很复杂的工作吗？',
                    likert_scale_min_label: '一点也不复杂',
                    likert_scale_max_label: '非常复杂',
                    likert_scale_values: likert_scale,
                    name: 'Complexity',
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您认为这项柠檬水预测任务对您来说很简单吗？',
                    likert_scale_min_label: '一点也不简单',
                    likert_scale_max_label: '非常简单',
                    likert_scale_values: likert_scale,
                    name: 'Simplity',
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您认为您有多大信心独立预测柠檬水销量？',
                    likert_scale_min_label: '完全没有信心',
                    likert_scale_max_label: '非常有信心',
                    likert_scale_values: likert_scale,
                    name: 'Self-Confidence',
                    required: true,
                }],
            ],
            button_label_back: '上一页',
            button_label_next: '下一页',
            button_label_finish: '继续'
        }
        //timeline.push(variables_measurement);

    //****************************************************第一部分反馈*****************************************************************
    var exp_algo_part1_feedback = {
        type: jsPsychHtmlKeyboardResponse,
        data: {
            taskname: 'exp_part1_feedback',
        },
        stimulus: function() {
            var team_intro_info = jsPsych.data.get().filter({
                task: 'team_manip'
            }).values()[0]
            var team_info = eval(JSON.parse(JSON.stringify(team_intro_info))).team_condition
            console.log(team_info)
            var algo_pre_task_info = jsPsych.data.get().filter({
                    phase: 'exp_delegation_part1',
                    task: 'exp_detail_info',
                }).values()
                //var info = eval(JSON.parse(JSON.stringify(algo_pre_task_info))).turevalue
                //console.log(info)
            var date_list = []
            var sale_list = []
            var prediction_list = []
            var bias_percent_list = []
            var profit_list = []
            for (var i = 0; i < 5; i++) {
                var algo_pre_task_info_per = algo_pre_task_info[i]
                console.log(algo_pre_task_info_per)
                var date = eval(JSON.parse(JSON.stringify(algo_pre_task_info_per))).taskdate
                var sale = eval(JSON.parse(JSON.stringify(algo_pre_task_info_per))).turevalue
                var prediction = eval(JSON.parse(JSON.stringify(algo_pre_task_info_per))).predictvalue
                var daily_profit = (prediction > sale) ? (sale - prediction * 0.2) : (prediction * 0.8)
                var bias_loss = (Math.abs(prediction - sale)) * 2
                var bias_percent = ((Math.abs(prediction - sale)) / sale) * 100
                var bias_percent = Math.floor(bias_percent * 100) / 100
                var final_profit = daily_profit - bias_loss
                var final_profit = Math.floor(final_profit * 100) / 100
                date_list.push(date)
                sale_list.push(sale)
                prediction_list.push(prediction)
                bias_percent_list.push(bias_percent)
                profit_list.push(final_profit)
            }
            var sum = 0
            var average = 0
            for (var j = 0; j < 5; j++) {
                sum = profit_list[j] + sum;
            }
            average = sum / profit_list.length
            average = Math.floor(average * 100) / 100

            return `
                            <p style="font: 24px 微软雅黑; line-height: 1.5em;color:Gray; text-align:center">【您已授权 ${team_info}提供的AI算法 为您做5次的销量预测】</p></br>
                            <p style="font: 22px 微软雅黑; line-height: 1.5em;color:Gray; text-align:center">5次销量预测结果评估如下：</p></br>
                            <div style="font:20px SimSun; line-height: 1em; text-align:center; color:black">
                            <p>第1次：预测日期为${date_list[0]}，实际销量是${sale_list[0]}杯，算法的预测为${prediction_list[0]}杯，预测偏差百分比为${bias_percent_list[0]}%，此次收益为${profit_list[0]}元。</p>
                            <p>第2次：预测日期为${date_list[1]}，实际销量是${sale_list[1]}杯，算法的预测为${prediction_list[1]}杯，预测偏差百分比为${bias_percent_list[1]}%，此次收益为${profit_list[1]}元。</p>
                            <p>第3次：预测日期为${date_list[2]}，实际销量是${sale_list[2]}杯，算法的预测为${prediction_list[2]}杯，预测偏差百分比为${bias_percent_list[2]}%，此次收益为${profit_list[2]}元。</p>
                            <p>第4次：预测日期为${date_list[3]}，实际销量是${sale_list[3]}杯，算法的预测为${prediction_list[3]}杯，预测偏差百分比为${bias_percent_list[3]}%，此次收益为${profit_list[3]}元。</p>
                            <p>第5次：预测日期为${date_list[4]}，实际销量是${sale_list[4]}杯，算法的预测为${prediction_list[4]}杯，预测偏差百分比为${bias_percent_list[4]}%，此次收益为${profit_list[4]}元。</p>
                            </br></br>
                            <p style='color:Gray;'>（按任意键继续）</p>
                            </div>`
        },
        on_finish: function(data) {
            var algo_pre_task_info = jsPsych.data.get().filter({
                    phase: 'exp_delegation_part1',
                    task: 'exp_detail_info',
                }).values()
                //var info = eval(JSON.parse(JSON.stringify(algo_pre_task_info))).turevalue
                //console.log(info)
            var date_list = []
            var sale_list = []
            var prediction_list = []
            var bias_percent_list = []
            var profit_list = []
            for (var i = 0; i < 5; i++) {
                var algo_pre_task_info_per = algo_pre_task_info[i]
                console.log(algo_pre_task_info_per)
                var date = eval(JSON.parse(JSON.stringify(algo_pre_task_info_per))).taskdate
                var sale = eval(JSON.parse(JSON.stringify(algo_pre_task_info_per))).turevalue
                var prediction = eval(JSON.parse(JSON.stringify(algo_pre_task_info_per))).predictvalue
                var daily_profit = (prediction > sale) ? (sale - prediction * 0.2) : (prediction * 0.8)
                var bias_loss = (Math.abs(prediction - sale)) * 2
                var bias_percent = ((Math.abs(prediction - sale)) / sale) * 100
                var bias_percent = Math.floor(bias_percent * 100) / 100
                var final_profit = daily_profit - bias_loss
                var final_profit = Math.floor(final_profit * 100) / 100
                date_list.push(date)
                sale_list.push(sale)
                prediction_list.push(prediction)
                bias_percent_list.push(bias_percent)
                profit_list.push(final_profit)
            }
            var sum = 0
            var average = 0
            for (var j = 0; j < 5; j++) {
                sum = profit_list[j] + sum;
            }
            average = sum / profit_list.length
            average = Math.floor(average * 100) / 100
            data.profit_part1 = average

        }

    }

    var if_shown_exp_algo_part1_feedback = {
        timeline: [exp_algo_part1_feedback],
        conditional_function: function() {
            var delegated = jsPsych.data.get().filter({
                task: 'delegate_decision_1'
            }).values()[0]
            var delegated = JSON.stringify(delegated)
            var delegated = eval(JSON.parse(delegated)).response.P0_Q2
            if (jsPsych.pluginAPI.compareKeys(delegated, '使用算法')) {
                return true;
            } else {
                return false;
            }
        }
    };

    //timeline.push(if_shown_exp_algo_part1_feedback);


    var exp_no_algo_part1_feedback = {
        type: jsPsychHtmlKeyboardResponse,
        data: {
            taskname: 'exp_part1_feedback',
        },
        stimulus: function() {
            var team_intro_info = jsPsych.data.get().filter({
                task: 'team_manip'
            }).values()[0]
            var team_info = eval(JSON.parse(JSON.stringify(team_intro_info))).team_condition
            console.log(team_info)
            var algo_pre_task_info = jsPsych.data.get().filter({
                    phase: 'exp_delegation_part1',
                    task: 'exp_detail_info',
                }).values()
                //var info = eval(JSON.parse(JSON.stringify(algo_pre_task_info))).turevalue
                //console.log(info)
            var date_list = []
            var sale_list = []
            var prediction_list = []
            var bias_percent_list = []
            var profit_list = []
            for (var i = 0; i < 5; i++) {
                var algo_pre_task_info_per = algo_pre_task_info[i]
                console.log(algo_pre_task_info_per)
                var date = eval(JSON.parse(JSON.stringify(algo_pre_task_info_per))).taskdate
                var sale = eval(JSON.parse(JSON.stringify(algo_pre_task_info_per))).turevalue
                var prediction = eval(JSON.parse(JSON.stringify(algo_pre_task_info_per))).response.pred_num
                var daily_profit = (prediction > sale) ? (sale - prediction * 0.2) : (prediction * 0.8)
                var bias_loss = (Math.abs(prediction - sale)) * 2
                var bias_percent = ((Math.abs(prediction - sale)) / sale) * 100
                var bias_percent = Math.floor(bias_percent * 100) / 100
                var final_profit = daily_profit - bias_loss
                var final_profit = Math.floor(final_profit * 100) / 100
                date_list.push(date)
                sale_list.push(sale)
                prediction_list.push(prediction)
                bias_percent_list.push(bias_percent)
                profit_list.push(final_profit)
            }
            var sum = 0
            var average = 0
            for (var j = 0; j < 5; j++) {
                sum = profit_list[j] + sum;
            }
            average = sum / profit_list.length
            average = Math.floor(average * 100) / 100

            return `
                            <p style="font: 24px 微软雅黑; line-height: 1.5em;color:Gray; text-align:center">【您未授权 ${team_info}提供的AI算法 为您做5次的销量预测】</p></br>
                            <p style="font: 22px 微软雅黑; line-height: 1.2em;color:Gray; text-align:center">5次销量预测结果评估如下：</p></br>
                            <div style="font:20px SimSun; line-height: 1em; text-align:center; color:black">
                            <p>第1次：预测日期为${date_list[0]}，实际销量是${sale_list[0]}杯，您的预测为${prediction_list[0]}杯，预测偏差百分比为${bias_percent_list[0]}%，此次收益为${profit_list[0]}元。</p>
                            <p>第2次：预测日期为${date_list[1]}，实际销量是${sale_list[1]}杯，您的预测为${prediction_list[1]}杯，预测偏差百分比为${bias_percent_list[1]}%，此次收益为${profit_list[1]}元。</p>
                            <p>第3次：预测日期为${date_list[2]}，实际销量是${sale_list[2]}杯，您的预测为${prediction_list[2]}杯，预测偏差百分比为${bias_percent_list[2]}%，此次收益为${profit_list[2]}元。</p>
                            <p>第4次：预测日期为${date_list[3]}，实际销量是${sale_list[3]}杯，您的预测为${prediction_list[3]}杯，预测偏差百分比为${bias_percent_list[3]}%，此次收益为${profit_list[3]}元。</p>
                            <p>第5次：预测日期为${date_list[4]}，实际销量是${sale_list[4]}杯，您的预测为${prediction_list[4]}杯，预测偏差百分比为${bias_percent_list[4]}%，此次收益为${profit_list[4]}元。</p>
                            </br></br>
                            <p style='color:Gray;'>（按任意键继续）</p>
                            </div>`
        },
        on_finish: function(data) {
            var algo_pre_task_info = jsPsych.data.get().filter({
                    phase: 'exp_delegation_part1',
                    task: 'exp_detail_info',
                }).values()
                //var info = eval(JSON.parse(JSON.stringify(algo_pre_task_info))).turevalue
                //console.log(info)
            var date_list = []
            var sale_list = []
            var prediction_list = []
            var bias_percent_list = []
            var profit_list = []
            for (var i = 0; i < 5; i++) {
                var algo_pre_task_info_per = algo_pre_task_info[i]
                console.log(algo_pre_task_info_per)
                var date = eval(JSON.parse(JSON.stringify(algo_pre_task_info_per))).taskdate
                var sale = eval(JSON.parse(JSON.stringify(algo_pre_task_info_per))).turevalue
                var prediction = eval(JSON.parse(JSON.stringify(algo_pre_task_info_per))).response.pred_num
                var daily_profit = (prediction > sale) ? (sale - prediction * 0.2) : (prediction * 0.8)
                var bias_loss = (Math.abs(prediction - sale)) * 2
                var bias_percent = ((Math.abs(prediction - sale)) / sale) * 100
                var bias_percent = Math.floor(bias_percent * 100) / 100
                var final_profit = daily_profit - bias_loss
                var final_profit = Math.floor(final_profit * 100) / 100
                date_list.push(date)
                sale_list.push(sale)
                prediction_list.push(prediction)
                bias_percent_list.push(bias_percent)
                profit_list.push(final_profit)
            }
            var sum = 0
            var average = 0
            for (var j = 0; j < 5; j++) {
                sum = profit_list[j] + sum;
            }
            average = sum / profit_list.length
            average = Math.floor(average * 100) / 100
            data.profit_part1 = average
        }

    }

    var if_shown_exp_no_algo_part1_feedback = {
        timeline: [exp_no_algo_part1_feedback],
        conditional_function: function() {
            var delegated = jsPsych.data.get().filter({
                task: 'delegate_decision_1'
            }).values()[0]
            var delegated = JSON.stringify(delegated)
            var delegated = eval(JSON.parse(delegated)).response.P0_Q2
            if (jsPsych.pluginAPI.compareKeys(delegated, '不使用算法')) {
                return true;
            } else {
                return false;
            }
        }
    };

    var exp_part2_intro = {
        type: jsPsychFullscreen,
        fullscreen_mode: true,
        message: `
                    <p style="font: 18pt 微软雅黑; text-align: left; line-height: 1.5em">【实验环节二】</p>
                    <div class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.2em'>
                    <p> 1. 本实验环节您需要做出<b>7</b>次柠檬水销量预测。</p>
                    <p> 2. 实验环节二的浮动酬金规则如下：</p>
                    <p style='text-indent:5rem'> (1)预测十次，每次根据预测偏差计算相应的报酬。</p>
                    <p style='text-indent:7rem'>· 偏差0杯，获得报酬10元。</p>
                    <p style='text-indent:7rem'>· 偏差1杯，获得报酬5元。</p>
                    <p style='text-indent:7rem'>· 偏差2杯，获得报酬2元。</p>
                    <p style='text-indent:7rem'>· 偏差大于2杯，获得报酬1元。</p>
                    <p style='text-indent:5rem'> (2)实验结束后，随机抽取一次预测收益作为浮动酬金2。</p>
                    <p line-height: 0em> # 最终酬金=基本酬金+浮动酬金1+浮动酬金2。</p></div>
                    ——————————————————————————————————————————————————————<br/><br/>
                    <div style="text-indent:4.375rem /* 70/16 */; color:Gray; font:16px 微软雅黑; line-height: 0.8em; text-align:left"> 
                    例如，正式实验环节2的浮动酬金的规则示例（非真实实验数据）：<br/>
                    <p>· 第一次预测15杯，实际销售13杯，第一次收益：2元。</p>
                    <p>· 第二次预测15杯，实际需求20杯，第二次收益：1元。</p>
                    <p>· 第三次预测15杯，实际需求15杯，第三次收益：10元。</p>
                    <p>· 随机抽取到第三次的收益，则浮动酬金2 = 10元。</p>
                    </div>
                    ———————————————————————————————————————————————————————<br/>
                    <p>`,
        button_label: '已了解酬金规则',
        delay_after: 100
    }

    var exp_algo_delegation_2 = {
            type: jsPsychSurvey,
            pages: [
                [{
                    type: 'html',

                    prompt: function() {
                        var team_intro_info = jsPsych.data.get().filter({
                            task: 'team_manip'
                        }).values()[0]
                        var team_info = eval(JSON.parse(JSON.stringify(team_intro_info))).team_condition
                        var html = `  
                        <p>现在${team_info}提供的算法依然可以使用，如果您使用算法预测，则算法预测收益将作为您的收益。请您做出以下决策：</p>`
                        return html
                    }
                }, {
                    type: 'likert',
                    prompt: '请问您有多大意愿使用该算法预测接下来1次的柠檬水销量？',
                    likert_scale_min_label: '完全不愿使用',
                    likert_scale_max_label: '非常愿意使用',
                    likert_scale_values: likert_scale,
                    required: true
                }, {
                    type: 'multi-choice',
                    prompt: '请您决定是否让该算法为您做接下来1次的销量预测:',
                    options: ["不使用算法", "使用算法"],
                    required: true,
                }]
            ],
            data: {
                task: 'delegate_decision_2'
            },
            button_label_finish: '继续'
        }
        //timeline.push(exp_algo_delegation_2)

    var algo_delegation_yes_2 = {
        type: jsPsychHtmlButtonResponse,
        stimulus: function() {
            var html = `
                <p style="font: 20pt 微软雅黑; text-align: left; line-height: 1.5em;color:Gray; ">【您已授权AI算法为您做接下来1次的销量预测】</p></br>
                <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.2em'> 接下来算法将为您进行预测。</p>
                <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.2em'>
                # 预测使用的基本信息（售价1元/杯，成本0.2元/杯）：</p>
                <div style="text-indent:4.375rem /* 70/16 */; font:18pt SimSun; line-height: 1em; text-align:left">
                <p>① 日期：${jsPsych.timelineVariable('Date')}：</p>
                <p>② 星期：${jsPsych.timelineVariable('Day')}</p>
                <p>③ 气温：${jsPsych.timelineVariable('Temperature')}°C</p>
                <p>④ 降水量：${jsPsych.timelineVariable('Rainfall')}ml</p>
                <p>⑤ 制作传单数：${jsPsych.timelineVariable('Flyers')}张</p></div>
                </br></br>
 
                `;
            return html;
        },
        choices: ['点击查看算法预测销量']
    }

    var algo_delegation_yes_result_2 = {
        type: jsPsychHtmlButtonResponse,
        stimulus: function() {
            var html = `
                <p style="font: 18pt 微软雅黑; text-align: left; line-height: 1.5em;color:Gray; ">【您已授权AI算法为您做接下来1次的销量预测】</p></br>
                <p style="font:22pt SimSun; line-height: 1.5em; text-align:center; color:black">
                算法的预测结果为：<b>${jsPsych.timelineVariable('Algo_pred_w')}</b>杯</p>
                </p>
                </br></br>
                `;
            return html;
        },
        choices: ['点击查看算法预测表现']
    }

    var algo_delegation_yes_result_eval_2 = {
        type: jsPsychHtmlKeyboardResponse,
        data: {
            taskname: 'result_eval',
            taskdate: jsPsych.timelineVariable('Date'),
            turevalue: jsPsych.timelineVariable('Sales'),
            algovalue: jsPsych.timelineVariable('Algo_pred_w'),
            //algovalue: jsPsych.timelineVariable('Flyers'),
        },
        stimulus: function() {
            var ture_sale = jsPsych.timelineVariable('Sales')
            var algo_pre = jsPsych.timelineVariable('Algo_pred_w')
            var bias = Math.abs(algo_pre - ture_sale)
            console.log(bias)
            if (bias == 0) {
                var profit = 10
            } else if (bias == 1) {
                var profit = 5
            } else if (bias == 2) {
                var profit = 2
            } else {
                var profit = 1
            }

            return `
                            <p style="font: 20pt 微软雅黑; line-height: 1.5em;color:Gray; text-align:center">【销量预测结果评估】</p></br>
                            <div style="font:20pt SimSun; line-height: 1em; text-align:center; color:black">
                            <p>实际销量为${ture_sale}杯</p>
                            <p>算法的预测为${algo_pre}杯</p>
                            <p>算法的预测偏差为${bias}杯</p>
                            <p>算法本次的预测收益为${profit}元</p></br>
                            <p style='color:Gray;'>（按任意键继续）</p>
                            </div>`
        },
        on_finish: function(data) {
            var ture_sale = jsPsych.timelineVariable('Sales')
            var algo_pre = jsPsych.timelineVariable('Algo_pred_w')
            var bias = Math.abs(algo_pre - ture_sale)
            if (bias == 0) {
                var profit = 10
            } else if (bias == 1) {
                var profit = 5
            } else if (bias == 2) {
                var profit = 2
            } else {
                var profit = 1
            }
            data.profit_part2 = profit
        }

    }

    var if_shown_algo_delegation_2 = {
        timeline: [algo_delegation_yes_2, algo_delegation_yes_result_2, algo_delegation_yes_result_eval_2],
        conditional_function: function() {
            var delegated = jsPsych.data.get().filter({
                task: 'delegate_decision_2'
            }).values()
            var delegated_trial_times = delegated.length
            var delegated_info = delegated[delegated_trial_times - 1]
            var delegated_info = JSON.stringify(delegated_info)
            var delegated_info = eval(JSON.parse(delegated_info)).response.P0_Q2
            if (jsPsych.pluginAPI.compareKeys(delegated_info, '使用算法')) {
                return true;
            } else {
                return false;
            }
        }
    };

    //选择不使用算法
    var algo_delegation_no_2 = {
        type: jsPsychHtmlButtonResponse,
        stimulus: function() {
            var html = `
                <p style="font: 20pt 微软雅黑; text-align: left; line-height: 1.5em;color:Gray; ">【您未授权AI算法为您做接下来1次的销量预测】</p></br>
                <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.2em'>
                接下来您需要自己预测柠檬水销量。</p>
                <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.2em'>
                # 预测使用的基本信息（售价1元/杯，成本0.2元/杯）：</p>
                <div style="text-indent:4.375rem /* 70/16 */; font:18pt SimSun; line-height: 1em; text-align:left">
                <p>① 日期：${jsPsych.timelineVariable('Date')}：</p>
                <p>② 星期：${jsPsych.timelineVariable('Day')}</p>
                <p>③ 气温：${jsPsych.timelineVariable('Temperature')}°C</p>
                <p>④ 降水量：${jsPsych.timelineVariable('Rainfall')}ml</p>
                <p>⑤ 制作传单数：${jsPsych.timelineVariable('Flyers')}张</p></div>
                </br></br>
 
                `;
            return html;
        },
        choices: ['点击填写预测销量']
    }

    var algo_delegation_no_result_2 = {
        type: jsPsychSurvey,
        pages: [
            [{
                type: 'html',
                prompt: '请根据提供的5项信息，进行预测：'
            }, {
                type: 'text',
                prompt: '· 您预计制作多少杯柃檬水？',
                name: 'pred_num',
                required: true
            }, {
                type: 'likert',
                prompt: '· 您对自己的预测结果有多大信心？',
                name: 'pred_confi_practice',
                likert_scale_min_label: '完全没有信心',
                likert_scale_max_label: '非常有信心',
                likert_scale_values: likert_scale,
                required: true
            }, ]
        ],
        button_label_finish: '提交预测结果',
        data: {
            task: jsPsych.timelineVariable('Date')
        }
    }

    var algo_delegation_no_result_eval_2 = {
        type: jsPsychHtmlKeyboardResponse,
        data: {
            taskname: 'result_eval',
            taskdate: jsPsych.timelineVariable('Date'),
            turevalue: jsPsych.timelineVariable('Sales'),

        },
        stimulus: function() {
            var self_pre = jsPsych.data.get().filter({
                task: jsPsych.timelineVariable('Date')
            }).values()[0]
            var self_pre = eval(JSON.parse(JSON.stringify(self_pre))).response.pred_num
                //var self_pre = parseInt(self_pre)
            var ture_sale = jsPsych.timelineVariable('Sales')
                //var ture_sale = parseInt(ture_sale)
            var bias = Math.abs(self_pre - ture_sale)
            console.log(bias)
            if (bias == 0) {
                var profit = 10
            } else if (bias == 1) {
                var profit = 5
            } else if (bias == 2) {
                var profit = 2
            } else {
                var profit = 1
            }

            return `
                            <p style="font: 20pt 微软雅黑; line-height: 1.5em;color:Gray; text-align:center">【销量预测结果评估】</p></br>
                            <div style="font:20pt SimSun; line-height: 1em; text-align:center; color:black">
                            <p>实际销量为${ture_sale}杯</p>
                            <p>您的预测为${self_pre}杯</p>
                            <p>您的预测偏差为${bias}杯</p>
                            <p>您本次的预测收益为${profit}元</p></br>
                            <p style='color:Gray;'>（按任意键继续）</p>
                            </div>`
        },
        on_finish: function(data) {
            var self_pre = jsPsych.data.get().filter({
                task: jsPsych.timelineVariable('Date')
            }).values()[0]
            var self_pre = eval(JSON.parse(JSON.stringify(self_pre))).response.pred_num
                //var self_pre = parseInt(self_pre)
            var ture_sale = jsPsych.timelineVariable('Sales')
                //var ture_sale = parseInt(ture_sale)
            var bias = Math.abs(self_pre - ture_sale)
            console.log(bias)
            if (bias == 0) {
                var profit = 10
            } else if (bias == 1) {
                var profit = 5
            } else if (bias == 2) {
                var profit = 2
            } else {
                var profit = 1
            }
            data.profit_part2 = profit
        }

    }

    var if_shown_no_algo_delegation_2 = {
        timeline: [algo_delegation_no_2, algo_delegation_no_result_2, algo_delegation_no_result_eval_2],
        conditional_function: function() {
            var delegated = jsPsych.data.get().filter({
                task: 'delegate_decision_2'
            }).values()
            var delegated_trial_times = delegated.length
            var delegated_info = delegated[delegated_trial_times - 1]
            var delegated_info = JSON.stringify(delegated_info)
            var delegated_info = eval(JSON.parse(delegated_info)).response.P0_Q2
            if (jsPsych.pluginAPI.compareKeys(delegated_info, '不使用算法')) {
                return true;
            } else {
                return false;
            }
        }
    };


    var exp_delegation_part2 = {
            timeline: [exp_algo_delegation_2, if_shown_algo_delegation_2, if_shown_no_algo_delegation_2],
            timeline_variables: exp_sales_stimuli_part2,
            data: {
                phase: 'exp_delegation_part2'
            },
            sample: {
                type: 'without-replacement',
                size: 7
            }
        }
        //timeline.push(exp_delegation_part2)


    //***************************************************第二阶段问卷*******************************************
    var scale = ["完全没有信心", "没有信心", "有点没有信心", "不确定", "有点信心", "有信心", "非常有信心"];

    var key_factors_survey_2 = {
            type: jsPsychFullscreen,
            fullscreen_mode: true,
            message: `
        <p style="font: 20pt 微软雅黑; line-height: 1.5em; text-align:center">【问卷填写】</p></br>
        <div style="font:20pt SimSun; line-height: 1em; text-align:center">
        <p>接下来您将进入第二阶段的问卷填写。</p>
        <p>填写结果影响到您之后的实验报酬，因此请认真填写！</p>
        <p style='color:Gray;'>（按任意键继续）</p>
        </div>
        <p>`,
            button_lable: '填写问卷',
            delay_after: 100
        }
        //timeline.push(key_factors_survey_2)


    var variables_measurement_part2 = {
            type: jsPsychSurvey,
            pages: [
                [{
                    type: 'text',
                    prompt: '请问您对当前这个算法有什么想法或者感受？',
                    textbox_rows: 3,
                    name: 'feeling_about_algo',
                    required: true
                }],

                [{
                    type: 'likert',
                    prompt: '· 您现在认为这份预测工作的难度如何？',
                    likert_scale_min_label: '难度很低',
                    likert_scale_max_label: '难度很高',
                    name: 'Difficulty',
                    likert_scale_values: likert_scale,
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 到目前为止，您对自己的经营表现满意吗？',
                    likert_scale_min_label: '非常不满意',
                    likert_scale_max_label: '非常满意',
                    name: 'Performance_eval',
                    likert_scale_values: likert_scale,
                    required: true,
                }],
                [{
                    type: 'ranking',
                    prompt: '· 您认为柠檬水预测任务中四个预测信息的重要性排序是怎样的？(上下拖动选项进行排序）',
                    name: 'Self_reasoning',
                    options: ['星期几', '温度', '降水量', '宣传单数量'],
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您认为该AI预测算法中四个因素的重要性排序和您自己预测的一样吗？',
                    likert_scale_min_label: '完全不一致',
                    likert_scale_max_label: '完全一致',
                    name: 'Reasoning_consistency',
                    likert_scale_values: likert_scale,
                    required: true,
                }],
                [{
                    type: 'likert',
                    prompt: '· 您现在在多大程度上信任此算法可以高质量地预测了柠檬水销量？',
                    likert_scale_min_label: '完全不信任',
                    likert_scale_max_label: '完全信任',
                    name: 'Trust2',
                    likert_scale_values: likert_scale,
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您现在有多大意愿在之后的经营工作中使用该AI预测算法？',
                    likert_scale_min_label: '完全没有意愿',
                    likert_scale_max_label: '非常有意愿',
                    name: 'Usage_willingness_part2',
                    likert_scale_values: likert_scale,
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 您有多大可能向别的柠檬水经营商推荐这个AI预测算法？',
                    likert_scale_min_label: '不可能推荐',
                    likert_scale_max_label: '一定会推荐',
                    name: 'Recommendation',
                    likert_scale_values: likert_scale,
                    required: true,
                }],
                [{
                    type: 'multi-select',
                    prompt: '· 关于本游戏中提到的算法，以下哪些说法是正确的？',
                    options: ["这个算法是基于AI实现的预测算法", "这个算法团队全部是专业人士", "这个算法的预测正确率是100%", "这个算法到目前为止都是免费使用的"],
                    name: 'attention_check_1',
                    required: true,
                }, {
                    type: 'multi-select',
                    prompt: '·  您收到的算法介绍内容中，算法团队包括哪些人？',
                    options: ["没有介绍包括哪些人", "AI算法设计专家等专业人员", "终端用户（柠檬水销售商）", "公园运营人员", "文化周组织人员"],
                    name: 'attention_check_2',
                    required: true,
                }]
            ],
            button_label_back: '上一页',
            button_label_next: '下一页',
            button_label_finish: '继续'
        }
        //timeline.push(variables_measurement_part2)

    //*****************************************第三阶段：付费*******************************
    var algo_price_intro = {
            type: jsPsychFullscreen,
            fullscreen_mode: true,
            message: `
            <p style="font: 20pt 微软雅黑; text-align: left; line-height: 1.5em;color:Gray; ">【算法费用变动】：</p></br>
            <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.5em'>
            经过一段时间的免费投放，算法团队宣布该AI预测算法的免费试用阶段已经结束，接下来如果使用需要进行<font color='red'>付费</font>。</p>
            <p class='context' style='text-indent:3.125rem /* 50/16 */; line-height: 1.5em'>
            算法团队将算法使用的单价定位：<font color='red'>5元/次</font>。</p>
            </br></br>
            <p>`,
            button_label: '我已了解付费信息',
            delay_after: 100
        }
        //timeline.push(algo_price_intro);

    var algo_purchase_1 = {
            type: jsPsychSurvey,
            pages: [
                [{
                    type: 'likert',
                    prompt: '· 请问您愿意购买该算法进行下一次的销量预测吗？',
                    likert_scale_min_label: '完全不愿意',
                    likert_scale_max_label: '非常愿意',
                    name: 'purchase_intention_1',
                    likert_scale_values: likert_scale,
                    required: true,
                }, {
                    type: 'text',
                    prompt: "当前，您最多愿意支付多少元购买该算法的服务？",
                    name: 'max_pay_1',
                    required: true,
                }]
            ],
            button_label_finish: '继续'
        }
        //timeline.push(algo_purchase_1);

    var algo_price_change = {
            timeline: [{
                type: jsPsychHtmlKeyboardResponse,
                stimulus: function() {
                    var html = `
                        <p style="font: 20pt 微软雅黑; text-align: left; line-height: 1.5em;color:Gray; ">【算法费用调整】：</p></br>
                        <div style="font:20pt SimSun; line-height: 1em; text-align:left; color:black">
                        <p style="font:20pt SimSun; line-height: 1.5em; text-align:left; color:black">该算法投入市场一段时间之后，算法团队根据市场销售表现，将算法使用定价<font color='red'>${jsPsych.timelineVariable('change')}</font>为：</p></br>
                        <p style="font:20pt SimSun; line-height: 1em; text-align:center; color:black"><font color='red'>${jsPsych.timelineVariable('price')}</font>元/次</p><br>
                        <p style='font:20pt SimSun; line-height: 1em; text-align:center;color:Gray;'>（按任意键继续）</p>
                        `;
                    return html;
                },
                name: 'algo_price_change',
                button_label: '已了解价格变动'
            }],
            timeline_variables: [{
                change: '提高',
                price: '8'
            }, {
                change: '降低',
                price: '2'
            }],
            sample: {
                type: 'without-replacement',
                size: 1
            }

        }
        //timeline.push(algo_price_change);

    var algo_purchase_2 = {
            type: jsPsychSurvey,
            pages: [
                [{
                    type: 'likert',
                    prompt: '· 请问您愿意购买该算法进行下一次的销量预测吗？',
                    likert_scale_min_label: '完全不愿意',
                    likert_scale_max_label: '非常愿意',
                    name: 'purchase_intention_2',
                    likert_scale_values: likert_scale,
                    required: true,
                }, {
                    type: 'text',
                    prompt: "当前，您最多愿意支付多少元购买该算法的服务？",
                    name: 'max_pay_2',
                    required: true,
                }, {
                    type: 'text',
                    prompt: "您认为算法团队为什么会调整算法的价格？",
                    name: 'price_change_reason',
                    required: true,
                }]
            ]
        }
        //timeline.push(algo_purchase_2);

    var key_factors_survey_3 = {
            type: jsPsychFullscreen,
            fullscreen_mode: true,
            message: `
        <p style="font: 20pt 微软雅黑; line-height: 1.5em; text-align:center">【问卷填写】</p></br>
        <div style="font:20pt SimSun; line-height: 1em; text-align:center">
        <p>接下来您将进入最后一阶段的问卷填写，请认真填写。</p>
        <p style='color:Gray;'>（按任意键继续）</p>
        </div>
        <p>`,
            button_lable: '填写问卷',
            delay_after: 100
        }
        //timeline.push(key_factors_survey_3)

    var variables_measurement_part3_PDB = {
            type: jsPsychSurveyLikert,
            preamble: '<p>请回答对以下观点的赞成程度</p>',
            questions: [{
                prompt: "组织中较低层次的人应该毫无疑义地执行较高层次的人的要求。",
                name: 'Self_PDB_1',
                labels: ['完全不同意', '不同意', '有点不同意', '不确定', '有点同意', '同意', '非常同意'],
                required: true,
            }, {
                prompt: "一个高效率的组织需要明确谁是领导者谁是追随者。",
                name: 'Self_PDB_2',
                labels: ['完全不同意', '不同意', '有点不同意', '不确定', '有点同意', '同意', '非常同意'],
                required: true,
            }, {
                prompt: "当追随者全心全意地信任他们的领导者时，这个团队更有机会取得最大的成功。",
                name: 'Self_PDB_3',
                labels: ['完全不同意', '不同意', '有点不同意', '不确定', '有点同意', '同意', '非常同意'],
                required: true,
            }, {
                prompt: "组织中的低层级人员在组织中不应该有太大的权力。",
                name: 'Self_PDB_4',
                labels: ['完全不同意', '不同意', '有点不同意', '不确定', '有点同意', '同意', '非常同意'],
                required: true,
            }],
            button_label: '继续'
        }
        //timeline.push(variables_measurement_part3_PDB);

    var likert_scale_3 = [{
        value: 1,
        text: '错误'
    }, {
        value: 2,
        text: '不清楚'
    }, {
        value: 3,
        text: '正确'
    }]

    var variables_measurement_part3_literacy = {
            type: jsPsychSurvey,
            pages: [
                [{
                    type: 'html',
                    prompt: '算法的应用十分广泛。接下来你将看到关于算法的一些陈述，请判断是否正确。',
                }, {
                    type: 'likert',
                    prompt: '· 算法所使用的数据库不能成为决定算法质量的决定性因素之一。',
                    name: 'Algo_literacy_1',
                    likert_scale_values: likert_scale_3,
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 我可以通过自己的使用行为影响算法。',
                    name: 'Algo_literacy_2',
                    likert_scale_values: likert_scale_3,
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 在有的应用背景中，算法建议结果可能随着用户不同而不同。',
                    name: 'Algo_literacy_3',
                    likert_scale_values: likert_scale_3,
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 当使用一个个性化的算法时，你得到的结果或者看到的内容大多和你之前的观点一致。',
                    name: 'Algo_literacy_4',
                    likert_scale_values: likert_scale_3,
                    required: true,
                }],
                [{
                    type: 'likert',
                    prompt: '· 算法可以像人类一样思考。',
                    name: 'Algo_literacy_5',
                    likert_scale_values: likert_scale_3,
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 算法不受政府审查机制的影响。',
                    name: 'Algo_literacy_6',
                    likert_scale_values: likert_scale_3,
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 算法带来的机会与风险并存。',
                    name: 'Algo_literacy_7',
                    likert_scale_values: likert_scale_3,
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 一些公司或者组织发布的定期重复的内容是已经由算法写好的了。',
                    name: 'Algo_literacy_8',
                    likert_scale_values: likert_scale_3,
                    required: true,
                }, {
                    type: 'likert',
                    prompt: '· 在使用算法时，人类从未参与其中。',
                    name: 'Algo_literacy_9',
                    likert_scale_values: likert_scale_3,
                    required: true,
                }, ]
            ],
            button_label_back: '上一页',
            button_label_next: '下一页',
            button_label_finish: '结束填写问卷'
        }
        //timeline.push(variables_measurement_part3_literacy);


    var basic_info_survey = {
            type: jsPsychFullscreen,
            fullscreen_mode: true,
            message: `
        <p style="font: 20pt 微软雅黑; line-height: 1.5em; text-align:center">【基本信息填写】</p></br>
        <div style="font:20pt SimSun; line-height: 1em; text-align:center">
        <p>在正式进入实验之前，您首先需要填写个人基本信息，并回答相关问项。</p>
        <p>您的信息我们将完全保密。</p>
        <p>填写结果影响到您之后的实验报酬，因此请认真填写！</p>
        <p style='color:Gray;'>（按任意键继续）</p>
        </div>
        <p>`,
            button_lable: '填写个人信息',
            delay_after: 100
        }
        //timeline.push(basic_info_survey)

    var basic_info = {
            type: jsPsychSurveyHtmlForm,
            preamble: `
                    <p style="font: 18pt 微软雅黑; text-align: left; line-height: 1.5em;color:Gray; ">请如实填写以下信息。</p>
            `,
            html: '<div style="font: 14pt SimSun; text-align: left; line-height: 1.5em; font-weight:bold"> <p> 1. 您的性别：<input type="text" id="test-resp-box" name="response" size="20" required/></p></br> <p> 2. 您的年龄：<input type="text" id="test-resp-box" name="response" size="20" required/></p></br> <p> 4. 您所学的专业：<input type="text" id="test-resp-box" name="response" size="20" required/></p></br></div>',
            autofocus: 'test-resp-box',
            button_label: '下一页',
            name: 'basic_info',
        }
        //timeline.push(basic_info)

    var basic_info_efficacy = {
        type: jsPsychSurvey,
        pages: [
            [{
                type: 'html',
                prompt: '请判断下列陈述是否符合您的情况。',
            }, {
                type: 'likert',
                prompt: '· 只要我非常努力地尝试，我总是能解决困难的问题',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'self_efficacy1',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 如果有人反对我，我可以找到手段和方法获得自己想要的东西',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'self_efficacy2',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 坚持并实现目标对我来说是简单的',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'self_efficacy3',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 我相信自己可以有效地处理突发事件',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'self_efficacy4',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 由于我的足智多谋，我知道如何处理不可预见的情况',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'self_efficacy5',
                likert_scale_values: likert_scale,
                required: true,
            }],
            [{
                type: 'html',
                prompt: '请判断下列陈述是否符合您的情况。',
            }, {
                type: 'likert',
                prompt: '· 如果我投入必要的努力，我可以解决大多数问题',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'self_efficacy6',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 我可以在面对困难时保持冷静，因为我相信自己的应对能力',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'self_efficacy7',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 当我遇到一个问题时，我通常可以找到几种解决方法',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'self_efficacy8',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 如果我遇到了麻烦，我通常可以找到一个解决方案',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'self_efficacy9',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 我通常可以处理遇到的任何事情',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'self_efficacy10',
                likert_scale_values: likert_scale,
                required: true,
            }],
            [{
                type: 'html',
                prompt: '请判断下列陈述是否符合您的情况。',
            }, {
                type: 'likert',
                prompt: '· 我更喜欢可以很大程度上控制自己工作内容和工作时间的工作',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_1',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 我喜欢参与政治活动，因为我想在管理政府方面有尽可能多的发言权',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_2',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 我尽量避免别人告诉我做什么的情况',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_3',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 我更愿意成为领导者而不是追随者',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_4',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 我喜欢能够影响别人的行为',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_5',
                likert_scale_values: likert_scale,
                required: true,
            }],
            [{
                type: 'html',
                prompt: '请判断下列陈述是否符合您的情况。',
            }, {
                type: 'likert',
                prompt: '· 别人通常知道什么对我来说是最好的',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_6',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 我喜欢自己做决定',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_7',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 我喜欢控制自己的命运',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_8',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 当我参与一个团体项目时，我宁愿由别人来担任领导角色',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_9',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 我认为自己一般比别人更有能力处理各种情况',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_10',
                likert_scale_values: likert_scale,
                required: true,
            }],
            [{
                type: 'html',
                prompt: '请判断下列陈述是否符合您的情况。',
            }, {
                type: 'likert',
                prompt: '· 我宁愿自己做项目，自己犯错误，也不愿听从别人的命令',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_11',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 即使做了最完美的计划，一个小小的意外事件也会破坏一切',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_12',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 我喜欢在开始工作之前好好了解一下工作内容',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_13',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 当看到一个问题时，我更愿意为解决这个问题做些什么，而不是坐视不管',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_14',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 当涉及到命令时，我更喜欢发出命令而不是接受命令',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_15',
                likert_scale_values: likert_scale,
                required: true,
            }],
            [{
                type: 'html',
                prompt: '请判断下列陈述是否符合您的情况。',
            }, {
                type: 'likert',
                prompt: '· 我希望我可以把生活中的许多日常决定交给别人处理',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_16',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 出行时，我尽量避免将自己置于可能被他人的失误所伤害的境地',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_17',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 我希望避免别人告诉我应该做什么的情况',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_18',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 在许多情况下，我宁愿只有一个选择，而不是必须自己做出决定',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_19',
                likert_scale_values: likert_scale,
                required: true,
            }, {
                type: 'likert',
                prompt: '· 我喜欢等等看看别人是否能解决问题，这样我就不必为之烦恼了',
                likert_scale_min_label: '完全不符合',
                likert_scale_max_label: '完全符合',
                name: 'desire_for_control_20',
                likert_scale_values: likert_scale,
                required: true,
            }],
            [{
                type: 'likert-table',
                prompt: '在一项游戏中，收益结果是根据抛硬币的结果决定的，请仔细阅读收益规则并决定是否接受游戏挑战。',
                statements: [{
                    prompt: '# 1.如果硬币正面朝上，你会失去20元；如果硬币背面朝上，你会获得60元。',
                    name: 'loss_aversion_1'
                }, {
                    prompt: '# 2.如果硬币正面朝上，你会失去30元；如果硬币背面朝上，你会获得60元。',
                    name: 'loss_aversion_2'
                }, {
                    prompt: '# 3.如果硬币正面朝上，你会失去40元；如果硬币背面朝上，你会获得60元。',
                    name: 'loss_aversion_3'
                }, {
                    prompt: '# 4.如果硬币正面朝上，你会失去50元；如果硬币背面朝上，你会获得60元。',
                    name: 'loss_aversion_4'
                }, {
                    prompt: '# 5.如果硬币正面朝上，你会失去60元；如果硬币背面朝上，你会获得60元。',
                    name: 'loss_aversion_5'
                }, {
                    prompt: '# 6.如果硬币正面朝上，你会失去70元；如果硬币背面朝上，你会获得60元。',
                    name: 'loss_aversion_6'
                }],
                options: ['接受', '拒绝'],
                required: true
            }]
        ],
        button_label_back: '上一页',
        button_label_next: '下一页',
        button_label_finish: '继续填写问卷'
    };
    //timeline.push(basic_info_efficacy);

    var exp_game_end = {
            type: jsPsychFullscreen,
            fullscreen_mode: true,
            message: `
                    <p style="font: 20pt 微软雅黑; text-align: center; line-height: 1.6em">
                    <b>
                        实验到这里已经完全结束。感谢您的参与！<br/><br/>
                        请点击按钮随机选取浮动酬金。<br/><br/>
			            为了保证您的实验数据可以有效保存，请您在<font color='red'>点击按钮之后不要有任何操作，并联系实验人员</font>。
                        </b> </br></br></br>
                    `,
            button_label: '随机抽取浮动酬金',
            delay_after: 100
        }
        //timeline.push(exp_game_end);

    var exp_end_pay = {
            type: jsPsychHtmlKeyboardResponse,
            stimulus: function() {
                //实验环节1

                var part1_feedback = jsPsych.data.get().filter({
                    taskname: 'exp_part1_feedback'
                }).values()[0]
                var part1_profit = eval(JSON.parse(JSON.stringify(part1_feedback))).profit_part1


                //实验环节2
                var i = Math.floor(Math.random() * 7)
                var part2_feedback = jsPsych.data.get().filter({
                    taskname: "result_eval"
                }).values()[i]
                var part2_profit = eval(JSON.parse(JSON.stringify(part2_feedback))).profit_part2
                var select_all_profit = 20.0 + part2_profit + part1_profit
                var select_all_profit = Math.floor(select_all_profit * 100) / 100
                return `
                            <p style="font: 20pt 微软雅黑; line-height: 1.5em;color:Gray; text-align:center">【实验酬金】</p></br>
                            <div style="font:20pt SimSun; line-height: 1em; text-align:center; color:black">
                            <p>实验阶段一：浮动酬金（5次平均收益）为 <b>${part1_profit}</b> 元</p>
                            <p>实验阶段二：浮动酬金（7次随机抽取）为 <b>${part2_profit}</b> 元</p>
                            <p> 您的总收益为 <b>${select_all_profit}</b> 元</p></br>
                            <p> 请不要继续操作，并及时联系实验人员~</p></br>
                            </div>`
            }
        }
        //timeline.push(exp_end_pay);


    //timeline.push(global_var);

    var global_var = {
        timeline: [set_html_style, preload, exp_open_remarks]
    }

    var basic_info_survey = {
        timeline: [basic_info_survey, basic_info, basic_info_efficacy]
    }

    var exp_background_remuneration = {
        timeline: [exp_game_task_intro, exp_interest_intro, exp_interest_test, exp_rule_intro]
    }

    var seven_day_prac = {
        timeline: [practice_trial_intro, exp_pre_pract7]
    }

    var manip_PDB = {
        timeline: [PDB_condition_random]
    }

    var formal_exp_intro = {
        timeline: [exp_pre_pract_end]
    }

    var manip_Team = {
        timeline: [exp_team_intro, team_manip, exp_algo_delegation_1, exp_delegation_part1_1]
    }

    var factors_survey_1 = {
        timeline: [key_factors_survey_1, variables_measurement]
    }

    //var feedback_part = {
    //    timeline: [exp_delegation_part1_1, exp_algo_delegation_2, exp_delegation_part1_2,
    //        exp_algo_delegation_3, exp_delegation_part1_3, exp_algo_delegation_4, exp_delegation_part2
    //    ]
    //}

    var feedback_part = {
        timeline: [if_shown_exp_algo_part1_feedback, if_shown_exp_no_algo_part1_feedback, exp_part2_intro, exp_delegation_part2]
    }

    var factors_survey_2 = {
        timeline: [key_factors_survey_2, variables_measurement_part2]
    }

    var algo_payment = {
        timeline: [algo_price_intro, algo_purchase_1, algo_price_change, algo_purchase_2]
    }

    var factors_survey_3 = {
        timeline: [key_factors_survey_3, variables_measurement_part3_PDB, variables_measurement_part3_literacy]
    }

    var factors_survey_3_new = {
        timeline: [key_factors_survey_3, basic_info, basic_info_efficacy, variables_measurement_part3_PDB, variables_measurement_part3_literacy]
    }

    var exp_end = {
        timeline: [exp_game_end, exp_end_pay]
    }

    var timeline = [
        global_var,
        //basic_info_survey,
        exp_background_remuneration,
        seven_day_prac,
        manip_PDB,
        formal_exp_intro,
        manip_Team,
        factors_survey_1,
        feedback_part,
        factors_survey_2,
        algo_payment,
        factors_survey_3_new,
        exp_end
    ]


    jsPsych.run(timeline);
</script>

</html>